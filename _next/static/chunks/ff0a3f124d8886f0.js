(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,53224,e=>{"use strict";var t=e.i(43476),r=e.i(71645);e.i(47167);let n="https://api.radioamador.info".replace(/\/$/,"");function i(e){if("number"==typeof e&&Number.isFinite(e))return e;if("string"==typeof e){let t=Number(e);if(Number.isFinite(t))return t}return 0}function o(e){return"string"==typeof e?e:""}function a(e){if("boolean"==typeof e)return e;if("string"==typeof e){let t=e.trim().toLowerCase();if("true"===t)return!0;if("false"===t)return!1}if("number"==typeof e){if(1===e)return!0;if(0===e)return!1}return!!e}function s(e){if(null!=e){if("number"==typeof e&&Number.isFinite(e))return e;if("string"==typeof e){let t=Number(e);if(Number.isFinite(t))return t}}}function u(e){if(null!=e&&"string"==typeof e&&e.trim())return e}let l=["static","cluster","timed","dynamic"];function f(e){if(!Array.isArray(e)||0===e.length)return;let t=e.map(e=>{let t=u(e.type),r=t&&l.includes(t)?t:"static";return{tgId:i(e.tgId),name:u(e.name),type:r,extTalkgroup:s(e.extTalkgroup),days:u(e.days),startTime:u(e.startTime),endTime:u(e.endTime)}}).filter(e=>e.tgId>0);return t.length>0?t:void 0}function c(e){if(!Array.isArray(e)||0===e.length)return;let t=e.map(e=>({tgId:i(e.tgId),name:u(e.name),type:"static"})).filter(e=>e.tgId>0);return t.length>0?t:void 0}function d(e){return e>=50&&e<=54?"6m":e>=144&&e<=148?"2m":e>=430&&e<=450?"70cm":e>=1240&&e<=1300?"23cm":e>=2300&&e<=2450?"13cm":"other"}function p(e){let t=function(e){if(Array.isArray(e.frequencies)&&e.frequencies.length>0)return e.frequencies.map(e=>({outputFrequency:i(e.outputFrequency),inputFrequency:i(e.inputFrequency),tone:s(e.tone),isPrimary:a(e.isPrimary)}));let t=i(e.outputFrequency),r=i(e.inputFrequency);return 0===t&&0===r?[]:[{outputFrequency:t,inputFrequency:r,tone:s(e.tone),isPrimary:!0}]}(e),r=function(e){if(Array.isArray(e.modes)&&e.modes.length>0){let t=["FM","DMR","C4FM","DSTAR","Digipeater","TETRA"];return e.modes.filter(e=>"string"==typeof e&&t.includes(e))}let t=[],r=o(e.modulation).toUpperCase(),n=a(e.dmr),i=a(e.dstar);return n&&t.push("DMR"),i&&t.push("DSTAR"),!r.includes("FM")||t.includes("DMR")||t.includes("DSTAR")||t.push("FM"),r.includes("C4FM")&&t.push("C4FM"),r.includes("TETRA")&&t.push("TETRA"),"DIGIPEATER"===r&&t.push("Digipeater"),"DMR"!==r||t.includes("DMR")||t.push("DMR"),"D-STAR"!==r||t.includes("DSTAR")||t.push("DSTAR"),("DMR / D-STAR"===r||"DMR/D-STAR"===r)&&(t.includes("DMR")||t.push("DMR"),t.includes("DSTAR")||t.push("DSTAR")),0===t.length&&t.push("FM"),t}(e),n=function(e,t){if("simplex"===e.nodeType||"repeater"===e.nodeType)return e.nodeType;if(t.length>0){let e=t.find(e=>e.isPrimary)||t[0];if(1e-4>Math.abs(e.outputFrequency-e.inputFrequency))return"simplex"}return"repeater"}(e,t);return{id:e.id,callsign:o(e.callsign),nodeType:n,frequencies:t,modes:r,fmBandwidth:u(e.fmBandwidth),latitude:i(e.latitude),longitude:i(e.longitude),qthLocator:u(e.qth_locator),address:u(e.address),power:s(e.power),antennaHeight:s(e.antennaHeight),coverage:u(e.coverage),isCrossband:function(e){if(0===e.length)return!1;let t=e.find(e=>e.isPrimary)||e[0];return d(t.inputFrequency)!==d(t.outputFrequency)}(t)||void 0,dmr:function(e){if(e.dmrConfig&&"object"==typeof e.dmrConfig){let t=e.dmrConfig,r=s(t.colorCode);if(void 0===r)return;return{colorCode:r,dmrId:s(t.dmrId),network:u(t.network),ts1Talkgroups:f(t.ts1Talkgroups)??c(t.ts1StaticTalkgroups),ts2Talkgroups:f(t.ts2Talkgroups)??c(t.ts2StaticTalkgroups),blockedTalkgroups:function(e){if(!Array.isArray(e)||0===e.length)return;let t=e.map(e=>{let t=u(e.slot);return{tgId:i(e.tgId),slot:t&&["1","2","both"].includes(t)?t:void 0}}).filter(e=>e.tgId>0);return t.length>0?t:void 0}(t.blockedTalkgroups),bmProfileSyncedAt:u(t.bmProfileSyncedAt)}}let t=s(e.dmrColorCode),r=u(e.dmrTalkgroups);if(void 0!==t||r)return{colorCode:t||1,ts2Talkgroups:function(e){if(!e?.trim())return;let t=e.split(",").map(e=>e.trim()).filter(Boolean).map(e=>{let t=e.indexOf("/");if(t>0){let r=parseInt(e.substring(0,t).trim(),10),n=e.substring(t+1).trim();return Number.isFinite(r)?{tgId:r,name:n||void 0,type:"static"}:null}let r=parseInt(e,10);return Number.isFinite(r)?{tgId:r,type:"static"}:null}).filter(e=>null!==e);return t.length>0?t:void 0}(r)}}(e),dstar:function(e){if(e.dstarConfig&&"object"==typeof e.dstarConfig){let t=e.dstarConfig,r=u(t.reflector),n=u(t.module),i=u(t.gateway);if(!r&&!n&&!i)return;return{reflector:r,module:n,gateway:i}}let t=u(e.dstarReflector),r=u(e.dstarModule);if(t||r)return{reflector:t,module:r}}(e),c4fm:function(e){if(!e.c4fmConfig||"object"!=typeof e.c4fmConfig)return;let t=e.c4fmConfig,r=u(t.node),n=u(t.room),i=u(t.network);if(r||n||i)return{node:r,room:n,network:i}}(e),tetra:function(e){if(!e.tetraConfig||"object"!=typeof e.tetraConfig)return;let t=e.tetraConfig,r=Array.isArray(t.talkgroups)?t.talkgroups.map(e=>i(e.id)).filter(e=>e>0):[],n=u(t.network);if(0!==r.length||n)return{talkgroups:r,network:n}}(e),echolink:function(e){if(e.echolinkConfig&&"object"==typeof e.echolinkConfig){let t=e.echolinkConfig;if(!a(t.enabled))return;return{enabled:!0,nodeNumber:s(t.nodeNumber),conference:u(t.conference)}}let t=s(e.echolinkNode);if(t)return{enabled:!0,nodeNumber:t}}(e),allstarNode:s(e.allstarNode),association:function(e){if(e&&"object"==typeof e&&e.id&&e.abbreviation)return{id:i(e.id),name:o(e.name),abbreviation:o(e.abbreviation),slug:o(e.slug)}}(e.association),owner:u(e.owner),sysops:function(e){if(Array.isArray(e.sysops)&&0!==e.sysops.length)return e.sysops.map(e=>({callsign:o(e.callsign),name:u(e.name),role:u(e.role)})).filter(e=>e.callsign)}(e),authorizedUntil:u(e.authorizedUntil),status:u(e.status),operatingHours:u(e.operatingHours),lastVerified:u(e.lastVerified),notes:u(e.notes),website:u(e.website),privateUrls:function(e){if(Array.isArray(e.privateUrls)&&0!==e.privateUrls.length)return e.privateUrls.map(e=>({type:o(e.type),url:o(e.url),description:u(e.description)})).filter(e=>e.type&&e.url)}(e)}}async function g(){let e=[],t=1;for(;;){let r=new URLSearchParams({limit:"200",page:t.toString(),depth:"1"}),i=await fetch(`${n}/api/repeaters?${r}`,{method:"GET",headers:{Accept:"application/json"},cache:"no-store"});if(!i.ok)throw Error(`Failed to fetch repeaters: HTTP ${i.status}`);let o=await i.json(),a=Array.isArray(o.docs)?o.docs:[];e.push(...a.map(p));let s="number"==typeof o.totalPages?o.totalPages:void 0,u=!!o.hasNextPage;if(0===a.length||!u&&(!s||t>=s)||(t+=1,s&&t>s))break}return e.sort((e,t)=>e.callsign.localeCompare(t.callsign))}var m=e.i(59410);let y=r.createContext(null);function h(){let e=r.useContext(y);if(!e)throw Error("useRepeaters must be used within a RepeatersProvider");return e}function b({initialData:e,children:n}){let[i,o]=r.useState(e),[a,s]=r.useState(!1),[u,l]=r.useState(null),[f,c]=r.useState(null),d=r.useCallback(async()=>{s(!0),l(null);try{let e=await g();o(e),(0,m.saveRepeatersCache)(e),c(Date.now())}catch(e){console.error("Failed to refresh repeaters:",e),l("Failed to refresh repeaters")}finally{s(!1)}},[]);return r.useEffect(()=>{let e=(0,m.getRepeatersCache)(),t=(0,m.getCacheTimestamp)();e&&e.length>0&&(o(e),c(t)),g().then(e=>{o(e),(0,m.saveRepeatersCache)(e),c(Date.now()),l(null)}).catch(t=>{console.error("Failed to refresh repeaters:",t),e&&0!==e.length||l("Failed to fetch repeaters")})},[]),(0,t.jsx)(y.Provider,{value:{repeaters:i,isRefreshing:a,fetchError:u,lastSyncTime:f,refreshRepeaters:d},children:n})}e.s(["default",()=>b,"useRepeaters",()=>h],53224)}]);